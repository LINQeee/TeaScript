class TS{static templates={};static addTemplate=(e,t)=>{this.templates.hasOwnProperty(e)||(this.templates[e]=t)};static initializeTemplate=(e,...t)=>{if(!this.templates.hasOwnProperty(e))throw Error(`Template ${e} does not exist`);return this.fromHTML(this.templates[e](...t))};static initializeHTMLTemplate=(e,...t)=>this.templates[e](...t);static replace=(e,t,r,a)=>{if(!a)return e.replace(t,r);let l=RegExp(t,"ig");return e.replace(l,r)};static replaceAll=(e,t,r,a)=>{if(!a)return e.replaceAll(t,r);let l=RegExp(t,"ig");return e.replaceAll(l,r)};static uniqueReplace=(e,t,r,a)=>{if(!a){let l=RegExp(`(?<!\\w)${t}(?!\\w)`,"g");return e.replace(l,r)}let i=RegExp(`(?<!\\w)${t}(?!\\w)`,"ig");return e.replace(i,r)};static uniqueReplaceAll=(e,t,r,a)=>{if(!a){let l=RegExp(`(?<!\\w)${t}(?!\\w)`,"g");return e.replaceAll(l,r)}let i=RegExp(`(?<!\\w)${t}(?!\\w)`,"ig");return e.replaceAll(i,r)};static fromHTML=(e,t=!0)=>{if(!(e=t?e:e.trim()))return null;let r=document.createElement("template");return r.innerHTML=e,r.content.children[0]};static toHTML=e=>e.outerHTML.trim();static q=e=>document.querySelector(e);static qAll=e=>document.querySelectorAll(e);static param=function e(t){let r=window.location.search.substring(1).split("&"),a,l;for(l=0;l<r.length;l++)if((a=r[l].split("="))[0]===t)return void 0===a[1]||decodeURIComponent(a[1]);return!1};static createInterval=(e,t,...r)=>(e(),setInterval(e,t,...r))}class Template{constructor(e,t){TS.addTemplate(e,t)}}class TSDate{static formatDate=(e,t)=>(t=formatYear(e,t),t=formatHour(e,t),t=formatDay(e,t),t=formatMinute(e,t),t=formatSecond(e,t),t=formatMonth(e,t),t=formatWeekDay(e,t))}const formatYear=(e,t)=>(t=TS.uniqueReplaceAll(t,"yyyy",e.getFullYear(),!0),t=TS.uniqueReplaceAll(t,"yy",e.toLocaleDateString("default",{year:"2-digit"}),!0)),formatHour=(e,t)=>(t=TS.uniqueReplaceAll(t,"hh12",e.toLocaleTimeString("default",{hour:"2-digit",hour12:!0}).replace(" ",""),!0),t=TS.uniqueReplaceAll(t,"hh",convertTwoDigit(e.getHours()),!0),t=TS.uniqueReplaceAll(t,"h12",e.toLocaleTimeString("default",{hour:"numeric",hour12:!0}).replace(" ",""),!0),t=TS.uniqueReplaceAll(t,"h",e.getHours(),!0)),formatMonth=(e,t)=>(t=TS.uniqueReplaceAll(t,"MMMM",e.toLocaleDateString("default",{month:"long"})),t=TS.uniqueReplaceAll(t,"MMM",e.toLocaleDateString("default",{month:"short"})),t=TS.uniqueReplaceAll(t,"MM",convertTwoDigit(e.getMonth()+1)),t=TS.uniqueReplaceAll(t,"M",e.toLocaleDateString("default",{month:"numeric"}))),formatDay=(e,t)=>(t=TS.uniqueReplaceAll(t,"dd",convertTwoDigit(e.getDate()),!0),t=TS.uniqueReplaceAll(t,"d",e.getDate(),!0)),formatWeekDay=(e,t)=>(t=TS.uniqueReplaceAll(t,"wwww",e.toLocaleDateString("default",{weekday:"long"}),!0),t=TS.uniqueReplaceAll(t,"www",e.toLocaleDateString("default",{weekday:"short"}),!0),t=TS.uniqueReplaceAll(t,"ww",e.toLocaleDateString("default",{weekday:"narrow"}),!0),t=TS.uniqueReplaceAll(t,"w",e.getDay(),!0)),formatMinute=(e,t)=>(t=TS.uniqueReplaceAll(t,"mm",convertTwoDigit(e.getMinutes())),t=TS.uniqueReplaceAll(t,"m",e.getMinutes())),formatSecond=(e,t)=>(t=TS.uniqueReplaceAll(t,"ss",convertTwoDigit(e.getSeconds()),!0),t=TS.uniqueReplaceAll(t,"s",e.getSeconds(),!0)),convertTwoDigit=e=>(10>+e&&(e="0"+e),e);class TSNavigator{paths={};history=[];constructor(e){this.paths=e;let t=TS.param("page");if(!t||!this.paths.hasOwnProperty(t)){document.body.appendChild(TS.initializeTemplate("SysError","Page not found: 404"));return}document.body.appendChild(TS.initializeTemplate(e[t])),this.history.push(t)}goToPage(e,t=!0){TS.qAll("body > :not(script)").forEach(e=>e.remove()),document.body.appendChild(TS.initializeTemplate(this.paths[e])),t&&this.history.push(e),console.log(JSON.stringify(this.history))}goBack(e=!0){e&&this.history.length>1&&this.history.pop();let t;t=1===this.history.length?0:e?this.history.length-1:this.history.length-2,this.goToPage(this.history[t],!e)}}class TSQuery{static METHOD={GET:"GET",HEAD:"HEAD",POST:"POST",PUT:"PUT",DELETE:"DELETE",CONNECT:"CONNECT",OPTIONS:"OPTIONS",TRACE:"TRACE",PATCH:"PATCH"};static STATUS={ERROR:"ERROR",SUCCESS:"SUCCESS"};constructor(...e){this.middlewares=[DefaultMiddleware],e&&(this.middlewares=[...this.middlewares,...e])}refetchRequest=async(e,t,r,a,l,i)=>{let s=async()=>{let{result:t,error:s,status:o}=await this.send(r,a,{...l,cacheEnabled:!1},i);e.result=t,e.error=s,e.status=o},o=TS.createInterval(s,t),n=()=>clearInterval(o);return n};send=async(e,t,r,a)=>{let l=!!r&&r.cacheEnabled;r={...r,method:t,body:a,cacheEnabled:void 0};let i,s={requestUrl:e,request:this.send,requestMethod:t,requestBody:a,requestOptions:r},o=!!l&&getRequestFromCache(e,t,r,a);return i=o||await this.fetch(e,r,s),this.callMiddlewares(s),l&&await cacheRequest(e,t,r,a,i),i};fetch=async(e,t,r)=>{try{let a=await fetch(e,t);if(a.ok)return r.responseStatus=TSQuery.STATUS.SUCCESS,{result:await this.convertResponseToData(a),status:a.status};return r.responseStatus=TSQuery.STATUS.ERROR,r.error=await a.text(),{error:await a.text(),status:a.status}}catch(l){if(l instanceof TypeError)return r.responseStatus=TSQuery.STATUS.ERROR,r.error={message:"Network error"},{error:"Network error",status:0};if(!(l instanceof Response))return r.responseStatus=TSQuery.STATUS.ERROR,r.error="An error occurred",{error:"An error occurred",status:500};{let i=await this.convertResponseToData(l);return r.responseStatus=TSQuery.STATUS.ERROR,r.error=i,{error:i,status:l.status}}}};convertResponseToData=async e=>e.headers.get("Content-Type").includes("application/json")?await e.json():e.headers.get("Content-Type").includes("plain/text")?await e.text():void 0;callMiddlewares=e=>{this.middlewares.forEach(async t=>await t.call(e))}}class Middleware{constructor(e){this.call=e}}const cacheRequest=async(e,t,r,a,l)=>{let i=JSON.stringify({url:e,options:r,method:t,body:a});sessionStorage.getItem(i)||sessionStorage.setItem(i,JSON.stringify(l))},getRequestFromCache=(e,t,r,a)=>{let l=JSON.stringify({url:e,options:r,method:t,body:a});return JSON.parse(sessionStorage.getItem(l))},DefaultMiddleware=new Middleware(e=>{let t=TSDate.formatDate(new Date,"hh:mm:ss");e.responseStatus===TSQuery.STATUS.SUCCESS?console.log(`${e.requestMethod} request: ${e.requestUrl} - ${t}`):console.error(`ERROR ${e.requestMethod} request: ${e.requestUrl} ${t}`)});new Template("SysError",e=>`<div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; background: #171717; color: #fff; border-radius: 5px; font-size: 20px">${e}</div>`);